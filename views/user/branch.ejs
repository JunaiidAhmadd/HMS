<%- include("partials/user_header", { pageTitle: branch.name + " â€“ Hostel Management" }) %>

  <body>

    <!-- USER NAVBAR -->
    <%- include("partials/user_navbar") %>

      <div class="container py-5">

        <!-- Branch name -->
        <h1 class="text-3xl font-semibold mb-4">
          <%= branch.name %>
        </h1>

        <!-- Photos carousel -->
        <% if (branch.photos && branch.photos.length> 0) { %>
          <div id="branchCarousel" class="carousel slide mb-4" data-bs-ride="carousel">

            <div class="carousel-inner rounded shadow">
              <% branch.photos.forEach((photo, i)=> { %>
                <div class="carousel-item <%= i === 0 ? 'active' : '' %>">
                  <img src="/<%= photo %>" class="d-block w-100" alt="Branch Image">
                </div>
                <% }) %>
            </div>

            <button class="carousel-control-prev" type="button" data-bs-target="#branchCarousel" data-bs-slide="prev">
              <span class="carousel-control-prev-icon"></span>
              <span class="visually-hidden">Previous</span>
            </button>

            <button class="carousel-control-next" type="button" data-bs-target="#branchCarousel" data-bs-slide="next">
              <span class="carousel-control-next-icon"></span>
              <span class="visually-hidden">Next</span>
            </button>

          </div>
          <% } %>

            <!-- Facilities -->
            <div class="mb-5">
              <h2 class="text-2xl font-semibold mb-3">Facilities</h2>
              <% if (branch.facilities && branch.facilities.length> 0) { %>
                <div class="d-flex flex-wrap gap-2">
                  <% branch.facilities.forEach(f=> { %>
                    <span class="badge bg-light text-primary border px-3 py-2 rounded-pill">
                      <i class="bi bi-stars me-1"></i>
                      <%= f %>
                    </span>
                    <% }) %>
                </div>
                <% } else { %>
                  <p class="text-muted fst-italic">No facilities listed for this branch.</p>
                  <% } %>
            </div>

            <!-- Available room types -->
            <div>
              <h2 class="text-2xl font-semibold mb-3">Available Rooms</h2>

              <div class="row g-4">
                <% rooms.forEach(room=> { %>

                  <div class="col-12 col-sm-6 col-lg-4">
                    <div class="card shadow-sm h-100 border-0 rounded-3 hover-up">

                      <!-- Room Image -->
                      <div style="height: 220px; overflow: hidden; position: relative;">
                        <img src="<%= room.images && room.images.length > 0 ? room.images[0] : '/images/room.png' %>"
                          class="card-img-top h-100 w-100" alt="<%= room.roomType %>" style="object-fit: cover;">
                        <span class="badge bg-primary position-absolute top-0 end-0 m-3 shadow-sm">
                          PKR <%= room.price.toLocaleString() %>
                        </span>
                      </div>

                      <div class="card-body d-flex flex-column p-4">
                        <h5 class="card-title fw-bold mb-1">
                          <%= room.roomType %>
                        </h5>
                        <small class="text-muted mb-3">
                          <i class="bi bi-people-fill"></i> Capacity: <%= room.capacity %>
                        </small>

                        <div class="mb-3">
                          <% if (room.facilities && room.facilities.length> 0) { %>
                            <div class="d-flex flex-wrap gap-1">
                              <% room.facilities.slice(0, 3).forEach(f=> { %>
                                <span class="badge bg-light text-dark border">
                                  <%= f %>
                                </span>
                                <% }) %>
                                  <% if (room.facilities.length> 3) { %>
                                    <span class="badge bg-light text-muted border">+<%= room.facilities.length - 3 %>
                                        </span>
                                    <% } %>
                            </div>
                            <% } else { %>
                              <small class="text-muted fst-italic">No amenities listed.</small>
                              <% } %>
                        </div>

                        <a href="/user/room/<%= room._id %>" class="btn btn-outline-primary mt-auto w-100 fw-semibold">
                          View Details
                        </a>

                      </div>
                    </div>
                  </div>

                  <% }) %>
              </div>

            </div>

      </div>

      <!-- USER FOOTER -->
      <%- include("partials/user_footer") %>

        <!-- JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  </body>

  </html>